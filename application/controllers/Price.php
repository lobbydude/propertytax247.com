<?phpif (!defined('BASEPATH'))    exit('No direct script access allowed');class Price extends CI_Controller {    public static $db;    public function __construct() {        parent::__construct();        $this->clear_cache();        self::$db = & get_instance()->db;        if (!$this->authenticate->isAdmin()) {            redirect('Admin_Login');        }    }    public function index() {        $data = array(            'title' => 'Price',            'main_content' => 'admin/price/index'        );        $this->load->view('admin/common/content', $data);    }    /* Add Price Details Start Here */    public function add_price() {        $add_price_plan = $this->input->post('add_price_plan');        $add_price_type = $this->input->post('add_price_type');        $add_price_orderype = $this->input->post('add_price_orderype');        $add_price_amt1 = $this->input->post('add_price_amt');        $add_price_amt = number_format((float) $add_price_amt1, 2, '.', '');        $sess_data = $this->session->all_userdata();        $inserted_id = $sess_data['admin_id'];        $data = array(            'Plan_Id' => $add_price_plan,            'Product_Type' => $add_price_type,            'Status' => 1        );        $this->db->where($data);        $q = $this->db->get('tbl_price');        $count = $q->num_rows();        if ($count == 0) {            $insert_data = array(                'Plan_Id' => $add_price_plan,                'Product_Type' => $add_price_type,                'Order_Type' => $add_price_orderype,                'Price' => $add_price_amt,                'Inserted_By' => $inserted_id,                'Inserted_Date' => date('Y-m-d H:i:s'),                'Status' => 1            );            $q = $this->db->insert('tbl_price', $insert_data);            if ($q) {                echo "success";            } else {                echo "fail";            }        } else {            echo "exists";        }    }    /* Add Price Details End Here */    /* Edit Price Details Start Here */    public function Editprice() {        $price_id = $this->input->post('price_id');        $data = array(            'price_id' => $price_id        );        $this->load->view('admin/price/edit_price', $data);    }    public function edit_Price() {        $edit_price_id = $this->input->post('edit_price_id');        $edit_price_plan = $this->input->post('edit_price_plan');        $edit_price_type = $this->input->post('edit_price_type');        $edit_price_orderype = $this->input->post('edit_price_orderype');        $edit_price_amt1 = $this->input->post('edit_price_amt');        $edit_price_amt = number_format((float) $edit_price_amt1, 2, '.', '');        $sess_data = $this->session->all_userdata();        $modified_id = $sess_data['admin_id'];        $data = array(            'Price_Id !=' => $edit_price_id,            'Plan_Id' => $edit_price_plan,            'Product_Type' => $edit_price_type,            'Status' => 1        );        $this->db->where($data);        $q = $this->db->get('tbl_price');        $count = $q->num_rows();        if ($count == 0) {            $update_data = array(                'Plan_Id' => $edit_price_plan,                'Product_Type' => $edit_price_type,                'Order_Type' => $edit_price_orderype,                'Price' => $edit_price_amt,                'Modified_By' => $modified_id,                'Modified_Date' => date('Y-m-d H:i:s')            );            $this->db->where('Price_Id', $edit_price_id);            $q = $this->db->update('tbl_price', $update_data);            if ($q) {                echo "success";            } else {                echo "fail";            }        } else {            echo "exists";        }    }    /* Edit Price Details End Here */    /* Delete Price Details Start Here */    public function Deleteprice() {        $price_id = $this->input->post('price_id');        $data = array(            'price_id' => $price_id        );        $this->load->view('admin/price/delete_price', $data);    }    public function delete_price() {        $delete_price_id = $this->input->post('delete_price_id');        $sess_data = $this->session->all_userdata();        $modified_id = $sess_data['admin_id'];        $update_data = array(            'Status' => 0,            'Modified_By' => $modified_id,            'Modified_Date' => date('Y-m-d H:i:s')        );        $this->db->where('Price_Id', $delete_price_id);        $q = $this->db->update('tbl_price', $update_data);        if ($q) {            echo "success";        } else {            echo "fail";        }    }    /* Delete Price Details End Here */    function clear_cache() {        $this->output->set_header("cache-control: no-store, no-cache, must-revalidate, no-transform, max-age=0, post-check=0, pre-check=0");        $this->output->set_header("Pragma:no-cache");    }}